%--------------------------------------------------------------------------
%
% deriveJacobian
%
% Austin Smith
% SIE-554A
% 11/04/2017
%
% Uses symbolic toolbox to compute Jacobians for EKF measurement matrices
%
%--------------------------------------------------------------------------

% 2-D Radar
syms az r rDot;
syms x y vx vy;

az    = atan(y/x);
r     = sqrt(x^2+y^2);
rDot  = (vx*x+vy*y)/r;

dPol_dCart = jacobian([az,r,rDot],[x,y,vx,vy]);
disp('Radar:');
disp(simplify(dPol_dCart,100));

% 2-D Triangulate
syms az1 az2 az1Dot az2Dot;
syms x21 y21;

az1    = atan(y/x);
az2    = atan((y-y21)/(x-x21));
az1Dot = 1/(1+(y1/x1)^2)*(vy*x1-y1*vx)/x1^2;
az2Dot = 1/(1+(y2/x2)^2)*(vy*x2-y2*vx)/x2^2;

dTri_dCart = jacobian([az1,az1Dot,az2,az2Dot],[x,y,vx,vy]);
disp('Triangulate:');
disp(simplify(dTri_dCart,100));

